# [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/)

## Exploit syntax:
* Utilize sharpup to scan victim box for common files or custom binaries that may be weaponized.


```powershell
# Runs all vulnerability checks regardless of integrity level or group membership:
sharpup audit

# Check only if there are modifiable paths in the user's %PATH% variable:
sharpup HijackablePaths

```

* Additionally, utilize syntax from Process_Injection methods:
[Process_injection](/Poshc2/instructions/Process_injection.md)

## Detection Technique:
* Querying Kibana to detect *services.exe* and *process create* for any new created process by services. Filtering out any new “Logged-in” events.

* Consider monitoring for the presence or loading (ex: Sysmon Event ID 6) of known vulnerable drivers that adversaries may drop and exploit to execute code in kernel mode.

* Monitor for evidence of process injection: 

    * Windows API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC/NtQueueApcThread, and those that can be used to modify memory within another process, such as VirtualAllocEx/WriteProcessMemory, may be used for this technique.

    * Linux specific calls such as the ptrace system call should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods.

## Resources

* https://github.com/GhostPack/SharpUp